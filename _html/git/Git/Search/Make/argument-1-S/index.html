<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>1-S (git.Git.Search.Make.1-S)</title><link rel="stylesheet" href="../../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../../../index.html">git</a></span></nav><header><h1><span class="keyword">Parameter</span> <span class="module-path">Git.Search.Make.1-S</span></h1></header><div class="spec module" id="module-Hash"><a href="#module-Hash" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Hash/index.html">Hash</a> : <a href="../../../../Git__/S/index.html#module-type-HASH">Git__.S.HASH</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Inflate"><a href="#module-Inflate" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Inflate/index.html">Inflate</a> : <a href="../../../../Git__/S/index.html#module-type-INFLATE">Git__.S.INFLATE</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Deflate"><a href="#module-Deflate" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Deflate/index.html">Deflate</a> : <a href="../../../../Git__/S/index.html#module-type-DEFLATE">Git__.S.DEFLATE</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Value"><a href="#module-Value" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Value/index.html">Value</a> : <a href="../../../Value/index.html#module-type-S">Value.S</a><span class="keyword"> with </span><span class="keyword">module </span><a href="../../../Value/module-type-S/Hash/index.html">Hash</a> := <a href="index.html#module-Hash">Hash</a><span class="keyword"> and </span><span class="keyword">module </span><a href="../../../Value/module-type-S/Inflate/index.html">Inflate</a> := <a href="index.html#module-Inflate">Inflate</a><span class="keyword"> and </span><span class="keyword">module </span><a href="../../../Value/module-type-S/Deflate/index.html">Deflate</a> := <a href="index.html#module-Deflate">Deflate</a><span class="keyword"> and </span><span class="keyword">module </span><a href="../../../Value/module-type-S/Blob/index.html">Blob</a> = <a href="../../../Blob/index.html#module-Make">Blob.Make(Hash)</a><span class="keyword"> and </span><span class="keyword">module </span><a href="../../../Value/module-type-S/Commit/index.html">Commit</a> = <a href="../../../Commit/index.html#module-Make">Commit.Make(Hash)</a><span class="keyword"> and </span><span class="keyword">module </span><a href="../../../Value/module-type-S/Tree/index.html">Tree</a> = <a href="../../../Tree/index.html#module-Make">Tree.Make(Hash)</a><span class="keyword"> and </span><span class="keyword">module </span><a href="../../../Value/module-type-S/Tag/index.html">Tag</a> = <a href="../../../Tag/index.html#module-Make">Tag.Make(Hash)</a><span class="keyword"> and </span><span class="keyword">type </span><a href="../../../Value/module-type-S/index.html#type-t">t</a><span class="keyword"> = </span><a href="../../../Value/Make/index.html#type-t">Value.Make(Hash)(Inflate)(Deflate).t</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Reference"><a href="#module-Reference" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Reference/index.html">Reference</a> : <a href="../../../Reference/index.html#module-type-S">Reference.S</a><span class="keyword"> with </span><span class="keyword">module </span><a href="../../../Reference/module-type-S/Hash/index.html">Hash</a> := <a href="index.html#module-Hash">Hash</a></code></div><div class="doc"></div></div><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div><div class="doc"><p>The type of the git repository.</p></div></div><div class="spec type" id="type-error#row"><a href="#type-error#row" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>error#row</code><code></code><code></code></div><div class="doc"><p>The type error.</p></div></div><div class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>error</code><span class="keyword"> = </span><span class="keyword">private </span><code>[&gt; </code><table class="variant"><tr id="type-error.Not_found" class="anchored"><td class="def constructor"><a href="#type-error.Not_found" class="anchor"></a><code><span class="keyword">| </span></code><code>`Not_found</code></td></tr></table><code> ]</code><code></code></div><div class="doc"><p>The type error.</p></div></div><div class="spec val" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_error : <a href="index.html#type-error">error</a> Fmt.t</code></div><div class="doc"><p>Pretty-printer of <a href="index.html#type-error">error</a>.</p></div></div><div class="spec type" id="type-buffer"><a href="#type-buffer" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>buffer</code><code></code><code></code></div><div class="doc"><p>The type for buffers.</p></div></div><div class="spec val" id="val-default_buffer"><a href="#val-default_buffer" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>default_buffer : unit <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-buffer">buffer</a></code></div><div class="doc"><p>The default buffer.</p></div></div><div class="spec val" id="val-buffer"><a href="#val-buffer" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>buffer : ?&#8288;ztmp:Cstruct.t <span class="keyword">&#8209;&gt;</span> ?&#8288;dtmp:Cstruct.t <span class="keyword">&#8209;&gt;</span> ?&#8288;raw:Cstruct.t <span class="keyword">&#8209;&gt;</span> ?&#8288;window:<a href="Inflate/index.html#type-window">Inflate.window</a> <span class="keyword">&#8209;&gt;</span> unit <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-buffer">buffer</a></code></div><div class="doc"></div></div><div class="spec val" id="val-dotgit"><a href="#val-dotgit" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>dotgit : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Fpath.t</code></div><div class="doc"><p><code class="code">dotgit state</code> returns the current <code class="code">&quot;.git&quot;</code> path used - eg. the default
<code class="code">?dotgit</code> value of create if the client does not notice a specific
value.</p></div></div><div class="spec val" id="val-root"><a href="#val-root" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>root : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> Fpath.t</code></div><div class="doc"><p><code class="code">root state</code> returns the current path of the repository. eg. the default
value <code class="code">?root</code> value of create if the client does not notice a specific
value.</p></div></div><div class="spec val" id="val-compression"><a href="#val-compression" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>compression : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">compression state</code> returns the current level of the compression used to
write a Git object - eg. the default value <code class="code">?compression</code> value of
create if the client does not notice a specific value.</p></div></div><div class="spec val" id="val-contents"><a href="#val-contents" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>contents : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> ((<a href="index.html#module-Hash">Hash</a>.t<span class="keyword"> * </span><a href="Value/index.html#type-t">Value.t</a>) list, <a href="index.html#type-error">error</a>) Stdlib.result Lwt.t</code></div><div class="doc"><p><code class="code">contents state</code> returns an associated list between the hash and its bind
git object. This list contains all git objects available in the current
git repository <code class="code">state</code>.</p></div></div><div class="spec val" id="val-size"><a href="#val-size" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>size : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> (int64, <a href="index.html#type-error">error</a>) Stdlib.result Lwt.t</code></div><div class="doc"><p><code class="code">size state hash</code> returns the size of the git object which respects the
predicate <code class="code">digest(object) = hash</code>. The size is how many byte(s) are
needed to store the serialized (but not deflated) git object in bytes
(without the header).</p></div></div><div class="spec val" id="val-read"><a href="#val-read" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>read : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> (<a href="Value/index.html#type-t">Value.t</a>, <a href="index.html#type-error">error</a>) Stdlib.result Lwt.t</code></div><div class="doc"><p><code class="code">read state hash</code> can retrieve a git object from the current repository
<code class="code">state</code>. It de-serializes the git object to an OCaml value.</p></div></div><div class="spec val" id="val-read_exn"><a href="#val-read_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>read_exn : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> <a href="Value/index.html#type-t">Value.t</a> Lwt.t</code></div><div class="doc"><p><code class="code">read_exn state hash</code> is an alias of <a href="index.html#val-read">read</a> but raise an exception
(instead to return a result) if the git object requested does not
exist or when we catch any others errors.</p></div></div><div class="spec val" id="val-mem"><a href="#val-mem" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>mem : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> bool Lwt.t</code></div><div class="doc"><p><code class="code">mem state hash</code> checks if one object satisfies the predicate
<code class="code">digest(object) = hash</code>.</p></div></div><div class="spec val" id="val-list"><a href="#val-list" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>list : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t list Lwt.t</code></div><div class="doc"><p><code class="code">list state</code> lists all git objects available in the current git
repository <code class="code">state</code>.</p></div></div><div class="spec val" id="val-write"><a href="#val-write" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>write : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="Value/index.html#type-t">Value.t</a> <span class="keyword">&#8209;&gt;</span> (<a href="index.html#module-Hash">Hash</a>.t<span class="keyword"> * </span>int, <a href="index.html#type-error">error</a>) Stdlib.result Lwt.t</code></div><div class="doc"><p><code class="code">write state v</code> writes the value <code class="code">v</code> in the git repository <code class="code">state</code>.</p></div></div><div class="spec val" id="val-fold"><a href="#val-fold" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>fold : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (<span class="type-var">'acc</span> <span class="keyword">&#8209;&gt;</span> ?&#8288;name:<a href="../../../Path/index.html#type-t">Path.t</a> <span class="keyword">&#8209;&gt;</span> length:int64 <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> <a href="Value/index.html#type-t">Value.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'acc</span> Lwt.t) <span class="keyword">&#8209;&gt;</span> path:<a href="../../../Path/index.html#type-t">Path.t</a> <span class="keyword">&#8209;&gt;</span> <span class="type-var">'acc</span> <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> <span class="type-var">'acc</span> Lwt.t</code></div><div class="doc"><p><code class="code">fold state f ~path acc hash</code> iters on any git objects reachable by the
git object <code class="code">hash</code> which located in <code class="code">path</code> (for example, if you iter on a
commit, <code class="code">path</code> should be <code class="code">&quot;.&quot;</code> - however, if you iter on a tree, <code class="code">path</code>
should be the directory path represented by your tree). For each git
objects, we notice the path <code class="code">name</code> (derived from <code class="code">path</code>) if the object is
a Blob or a Tree, the <code class="code">length</code> or the git object (see <a href="index.html#val-size">size</a>), the
<code class="code">hash</code> and the <code class="code">value</code>.</p><p>If the <code class="code">hash</code> points to:</p><ul><li><a href="../../../Blob/Make/index.html#type-t">Value.Blob.t</a>: <code class="code">f</code> is called only one time with the OCaml value
of the <i>blob</i>.</li><li><a href="../../../Tree/Make/index.html#type-t">Value.Tree.t</a>: <code class="code">f</code> is called firstly with the
Ocaml value of the pointed <i>tree</i> by the hash <code class="code">hash</code>. Then, we <i>iter</i>
(and call <code class="code">f</code> for each iteration) in the list of entries of the <i>tree</i>.
Finally, we retrieve recursively all sub-tree objects and do an ascending
walk. <code class="code">f</code> is never called more than one time for each hash.</li><li><a href="../../../Commit/Make/index.html#type-t">Value.Commit.t</a>: <code class="code">f</code> is called firstly with the OCaml value of the
pointed <i>commit</i> by the hash <code class="code">hash</code>. Then, it follozs recursively all
parents of the current commit, Finallym it starts a <code class="code">fold</code> inside the
pointed root <i>tree</i> git object of each <i>commit</i> previously retrieved.
<code class="code">f</code> never called more than one time for each hash.</li><li><a href="../../../Tag/Make/index.html#type-t">Value.Tag.t</a>:
<code class="code">f</code> is called firstly with the OCaml value of the pointed <i>tag</i> by the
hash <code class="code">hash</code>. Then, it follows the git object pointed by the <i>tag</i>.</li></ul><p>Any retrieved <a href="index.html#type-error">error</a> is missed.</p></div></div><div class="spec val" id="val-iter"><a href="#val-iter" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>iter : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (<a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> <a href="Value/index.html#type-t">Value.t</a> <span class="keyword">&#8209;&gt;</span> unit Lwt.t) <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"></div></div><div class="spec module" id="module-Pack"><a href="#module-Pack" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Pack/index.html">Pack</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Ref"><a href="#module-Ref" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Ref/index.html">Ref</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec val" id="val-reset"><a href="#val-reset" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>reset : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (unit, <a href="index.html#type-error">error</a>) Stdlib.result Lwt.t</code></div><div class="doc"><p><code class="code">reset t</code> removes all things of the git repository <code class="code">t</code> and ensures it
will be empty.</p></div></div><div class="spec val" id="val-clear_caches"><a href="#val-clear_caches" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>clear_caches : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> unit Lwt.t</code></div><div class="doc"><p><code class="code">clear_caches t</code> drops all values stored in the internal caches binded
with the git repository <code class="code">t</code>.</p></div></div><div class="spec val" id="val-read_inflated"><a href="#val-read_inflated" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>read_inflated : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t <span class="keyword">&#8209;&gt;</span> ([ `Commit | `Tag | `Blob | `Tree ]<span class="keyword"> * </span>Cstruct.t) option Lwt.t</code></div><div class="doc"><p><code class="code">read_inflated state hash</code> returns the inflated git object which respect
the predicate <code class="code">digest(value) = hash</code>. We return the kind of the object
and the inflated value as a <span class="xref-unresolved" title="unresolved reference to &quot;Cstruct.t&quot;">Cstruct.t</span> (which the client can take the
ownership).</p></div></div><div class="spec val" id="val-write_inflated"><a href="#val-write_inflated" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>write_inflated : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> kind:[ `Commit | `Tree | `Blob | `Tag ] <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t Lwt.t</code></div><div class="doc"><p><code class="code">write_inflated state kind raw</code> writes the git object in the git
repository <code class="code">state</code> and associates the kind to this object. This function
does not verify if the raw data is well-defined (and respects the Git
format). Then, this function returns the hash produced from the kind and
the inflated raw to let the user to retrieve it.</p></div></div><h2>Backend Features</h2><div class="spec val" id="val-has_global_watches"><a href="#val-has_global_watches" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>has_global_watches : bool</code></div><div class="doc"></div></div><div class="spec val" id="val-has_global_checkout"><a href="#val-has_global_checkout" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>has_global_checkout : bool</code></div><div class="doc"></div></div></body></html>