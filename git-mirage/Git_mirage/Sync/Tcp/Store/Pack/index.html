<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Pack (git-mirage.Git_mirage.Sync.Tcp.Store.Pack)</title><link rel="stylesheet" href="../../../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../../../../index.html">git-mirage</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Git_mirage.Sync.Tcp.Store.Pack</span></h1></header><div class="spec type" id="type-stream"><a href="#type-stream" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>stream</code><code><span class="keyword"> = </span>unit <span class="keyword">&#8209;&gt;</span> Cstruct.t option Lwt.t</code><code></code></div><div class="doc"><p>The stream contains the PACK flow.</p></div></div><div class="spec val" id="val-from"><a href="#val-from" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>from : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-stream">stream</a> <span class="keyword">&#8209;&gt;</span> (<a href="../index.html#module-Hash">Hash</a>.t<span class="keyword"> * </span>int, <a href="../index.html#type-error">error</a>) Stdlib.result Lwt.t</code></div><div class="doc"><p><code class="code">from git stream</code> populates the Git repository <code class="code">git</code> from the PACK flow
<code class="code">stream</code>. If any error is encountered, any Git objects of the PACK flow
are not added in the Git repository.</p></div></div><div class="spec val" id="val-make"><a href="#val-make" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>make : <a href="../index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;window:[ `Object of int | `Memory of int ] <span class="keyword">&#8209;&gt;</span> ?&#8288;depth:int <span class="keyword">&#8209;&gt;</span> <a href="../Value/index.html#type-t">Value.t</a> list <span class="keyword">&#8209;&gt;</span> (<a href="index.html#type-stream">stream</a><span class="keyword"> * </span>(Checkseum.Crc32.t<span class="keyword"> * </span>int64) <a href="../Hash/index.html#module-Map">Hash.Map</a>.t Lwt_mvar.t, <a href="../index.html#type-error">error</a>) Stdlib.result Lwt.t</code></div><div class="doc"><p><code class="code">make ?window ?depth values</code> makes a PACK stream from a list of
<a href="../Value/index.html#type-t">Value.t</a>.</p><p><code class="code">?window</code> specifies the weight of the window while the delta-ification.
The client can limit the weight by the number of objects in the windoz
(by default, is 10) or by the weight in byte of the window in your
memory.</p><p><code class="code">depth</code> (default is <code class="code">50</code>) limits the depth of the delta-ification.</p><p>Then, the function returns a stream and a protected variable which
contains a representation of the associated IDX file of the PACK
stream. This protected variable is available (<code class="code">Lwt_mvar.take</code>) only <b>at the end</b> of the PACK stream. That means, the client needs to consume
all of the stream and only then he can take the <code class="code">Graph.t</code> associated.</p></div></div></body></html>