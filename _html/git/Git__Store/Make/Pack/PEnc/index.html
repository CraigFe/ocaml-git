<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>PEnc (git.Git__Store.Make.Pack.PEnc)</title><link rel="stylesheet" href="../../../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../../../index.html">git</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Git__Store.Make.Pack.PEnc</span></h1></header><div class="spec module" id="module-Hash"><a href="#module-Hash" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Hash/index.html">Hash</a> : <a href="../../../../Git__/S/index.html#module-type-HASH">Git__.S.HASH</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Deflate"><a href="#module-Deflate" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Deflate/index.html">Deflate</a> : <a href="../../../../Git__/S/index.html#module-type-DEFLATE">Git__.S.DEFLATE</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Entry"><a href="#module-Entry" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Entry/index.html">Entry</a> : <a href="../../../../Git/Pack/index.html#module-type-ENTRY">Git.Pack.ENTRY</a><span class="keyword"> with </span><span class="keyword">module </span><a href="../../../../Git/Pack/module-type-ENTRY/Hash/index.html">Hash</a> := <a href="index.html#module-Hash">Hash</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Delta"><a href="#module-Delta" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Delta/index.html">Delta</a> : <a href="../../../../Git/Pack/index.html#module-type-DELTA">Git.Pack.DELTA</a><span class="keyword"> with </span><span class="keyword">module </span><a href="../../../../Git/Pack/module-type-DELTA/Hash/index.html">Hash</a> := <a href="index.html#module-Hash">Hash</a><span class="keyword"> and </span><span class="keyword">module </span><a href="../../../../Git/Pack/module-type-DELTA/Entry/index.html">Entry</a> := <a href="index.html#module-Entry">Entry</a></code></div><div class="doc"></div></div><div class="spec module" id="module-Hunk"><a href="#module-Hunk" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Hunk/index.html">Hunk</a> : <a href="../../../../Git/Pack/index.html#module-type-H">Git.Pack.H</a><span class="keyword"> with </span><span class="keyword">module </span><a href="../../../../Git/Pack/module-type-H/Hash/index.html">Hash</a> := <a href="index.html#module-Hash">Hash</a></code></div><div class="doc"><p>The Map tree zhich zill represent the IDX file of the PACK stream.</p></div></div><div class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>error</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-error.Deflate_error" class="anchored"><td class="def constructor"><a href="#type-error.Deflate_error" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Deflate_error</span><span class="keyword"> of </span><a href="Deflate/index.html#type-error">Deflate.error</a></code></td><td class="doc"><p>(** Appears when the deflate algorithm raises an error. *)</p></td></tr><tr id="type-error.Invalid_hash" class="anchored"><td class="def constructor"><a href="#type-error.Invalid_hash" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Invalid_hash</span><span class="keyword"> of </span><a href="index.html#module-Hash">Hash</a>.t</code></td><td class="doc"><p>(** Appears when the hash requested does not exist. *)</p></td></tr></table><code></code></div><div class="doc"><p>The type error.</p></div></div><div class="spec val" id="val-pp_error"><a href="#val-pp_error" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>pp_error : <a href="index.html#type-error">error</a> Fmt.t</code></div><div class="doc"><p>Pretty-printer for <a href="index.html#type-error">error</a>.</p></div></div><div class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>t</code><code></code><code></code></div><div class="doc"><p>The type of the encoder.</p></div></div><div class="spec val" id="val-used_out"><a href="#val-used_out" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>used_out : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">used_out ลง</code> returns how many byte <code class="code">t</code> wrote in the current buffer
noticed to the previous call of <a href="index.html#val-eval">eval</a>.</p></div></div><div class="spec val" id="val-used_in"><a href="#val-used_in" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>used_in : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> int</code></div><div class="doc"><p><code class="code">used_in ลง</code> returns how many byte <code class="code">t</code> consumed in the current buffer
noticed to the previous call of <a href="index.html#val-eval">eval</a>.</p></div></div><div class="spec val" id="val-flush"><a href="#val-flush" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>flush : int <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p><code class="code">flush off len t</code> provides <code class="code">t</code> with <code class="code">len</code> bytes to write, starting at
<code class="code">off</code>. This byte range is written by calls to <a href="index.html#val-eval">eval</a> with <code class="code">t</code> until
<code class="code">`Flush</code> is returned.</p></div></div><div class="spec val" id="val-refill"><a href="#val-refill" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>refill : int <span class="keyword">&#8209;&gt;</span> int <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p><code class="code">refill off len t</code> provides a new <code class="code">t</code> with <code class="code">len</code> bytes to read, starting
at <code class="code">off</code>. This byte range is read by calls to <a href="index.html#val-eval">eval</a> with <code class="code">t</code> until
<code class="code">`Await</code> is returned. The client should fill by the <a href="index.html#val-expect">expect</a> git object.</p></div></div><div class="spec val" id="val-finish"><a href="#val-finish" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>finish : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p><code class="code">finish t</code> provides a new <code class="code">t</code> which terminate to serialize the current
Git object. The next call of <a href="index.html#val-eval">eval</a> should not return an <code class="code">`Await</code> value
unless the output space is enough to start to serialize the next entry.</p></div></div><div class="spec val" id="val-expect"><a href="#val-expect" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>expect : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#module-Hash">Hash</a>.t</code></div><div class="doc"><p><code class="code">expect t</code> returns the object expected to the serialization. At this
time, the serializer requests the inflated raw of this git object. The
client is able to use it only when <a href="index.html#val-eval">eval</a> return <code class="code">`Await</code>. The encoder
does not wqnt the ownership of the inflated raw, it access on it only as
a read-only flow (that means, the src <span class="xref-unresolved" title="unresolved reference to &quot;Cstruct.t&quot;">Cstruct.t</span> could be physicaly the
same.</p></div></div><div class="spec val" id="val-idx"><a href="#val-idx" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>idx : <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> (Checkseum.Crc32.t<span class="keyword"> * </span>int64) <a href="Hash/index.html#module-Map">Hash.Map</a>.t</code></div><div class="doc"><p><code class="code">idx t</code> returns a Map tree which contains the CRC-32 checksum and the
absolute offset for each Git object serialized. The client is able to use
it only when <a href="index.html#val-eval">eval</a> returns <code class="code">`End</code>.</p></div></div><div class="spec val" id="val-default"><a href="#val-default" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>default : Cstruct.t <span class="keyword">&#8209;&gt;</span> (<a href="Entry/index.html#type-t">Entry.t</a><span class="keyword"> * </span><a href="Delta/index.html#type-t">Delta.t</a>) list <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a></code></div><div class="doc"><p>Make a new encoder <a href="index.html#type-t">t</a> of the PACK stream.</p><p><code class="code">tmp</code> is a <code class="code">Cstruct.t</code> used as an internal output of the Hunk Encoder
<a href="../../../../Git/Pack/module-type-H/index.html">Git__.Git.Pack.H</a>. We let the user to allocate the optimized length for this temporary
buffer and we take the ownership (so, you don't use it to another
computer).</p><p>Then, the client need to notice the ordered list of what he wants to
serialize.</p></div></div><div class="spec val" id="val-eval"><a href="#val-eval" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>eval : Cstruct.t <span class="keyword">&#8209;&gt;</span> Cstruct.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-t">t</a> <span class="keyword">&#8209;&gt;</span> [ `Flush of <a href="index.html#type-t">t</a> | `Await of <a href="index.html#type-t">t</a> | `End of <a href="index.html#type-t">t</a><span class="keyword"> * </span><a href="index.html#module-Hash">Hash</a>.t | `Error of <a href="index.html#type-t">t</a><span class="keyword"> * </span><a href="index.html#type-error">error</a> ]</code></div><div class="doc"><p><code class="code">eval src t</code> is:</p><ul><li><code class="code">`Await t</code> iff <code class="code">t</code> needs more input storage. The client must use
<a href="index.html#val-refill">refill</a> to provide a new buffer and then call <a href="index.html#val-eval">eval</a> with <code class="code">`Await</code>
until other value returned.</li><li><code class="code">`Flush t</code> iff <code class="code">t</code> needs more output
storage. The client must use <a href="index.html#val-flush">flush</a> to provide a new buffer and then
call <a href="index.html#val-eval">eval</a> with <code class="code">`Flush</code> until other value returned.</li><li><code class="code">`End (t,
      hash)</code> when <code class="code">t</code> is done. Then, <code class="code">t</code> sticks on this situation, the client
can remove it. <code class="code">hash</code> is the hash calculated of the PACK stream.</li><li><code class="code">`Error (t, exn)</code> iff the encoder <code class="code">t</code> meet an <a href="index.html#type-error">error</a><code class="code">exn</code>. The encoder
can't continue and sticks in this situation.</li></ul></div></div></body></html>